<!DOCTYPE html>
<html lang="en">
<head>
    <title>Adding & removing states</title>
    <script src="/assets/vendor/jquery.min.js"></script>
    <link  href="/assets/vendor/bootstrap.min.css" rel="stylesheet" >
    <script src="/assets/js/state-machine.js"></script>
    <script src="/assets/js/setup.js"></script>
    <link  href="/assets/css/styles.css" rel="stylesheet">
    <style type="text/css">
        #more-controls button{
            width: 35px;
        }
    </style>
</head>
<body>

    <h1>Adding & removing states</h1>

    <main class="states">

        <section id="states"></section>

        <div>
            <section id="more-controls" style="display: inline-block">
                <button class="btn btn-sm" id="btnRemove">-</button>
                <button class="btn btn-sm" id="btnAdd">+</button>
            </section>

            <section id="controls" style="display: inline-block">
                <button class="btn btn-sm" name="back">Back</button>
                <button class="btn btn-sm" name="next">Next</button>
            </section>
        </div>

    </main>

    <section id="info">
        <p>StateMachine supports adding and removing states on the fly .</p>
        <p>This example allows you to add and remove states, adding the correct transitions for you, and StateMachine takes care of removing them for you when you remove the state.</p>
        <p>When you remove a state, you can optionally specify a state to go to, should you be on the state you are deleting.</p>
    </section>

    <script>

        var config = {

            initial: 'A',

            transitions: [

            ],

            handlers: {
                add: function () {
                    console.log('state added!')
                },
                remove: function () {
                    console.log('state removed!')
                }
            }

        };

        var fsm = setup(new StateMachine(config));

        var $states = $('#states');
        var states  = 'ABCDEFGHIJKL'.split('');

        function addState()
        {
            var index = $states.children().length;
            if(index < states.length)
            {
                var to    = states[index];
                var from  = states[index - 1];
                if(from && to)
                {
                    fsm.add('next', from, to);
                    fsm.add('back', to, from);
                }
                $states.append('<article id="' +to+ '">State ' +to+ '</article>');
                update();
            }

        }

        function removeState()
        {
            var index = $states.children().length;
            if(index > 1)
            {
                var $state = $states.find('article:last-child');
                fsm.remove($state.attr('id'));
                $state.remove();
            }
        }

        $('#btnAdd').on('click', addState);
        $('#btnRemove').on('click', removeState);

        addState();

    </script>
</body>
</html>