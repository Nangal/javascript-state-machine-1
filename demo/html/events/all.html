<!DOCTYPE html>
<html lang="en">
<head>
    <title>Events</title>
    <script src="/assets/vendor/jquery.min.js"></script>
    <link href="/assets/vendor/bootstrap.min.css" rel="stylesheet" >
    <script src="/assets/js/state-machine.js"></script>
    <script src="/assets/js/setup.js"></script>
    <link href="/assets/css/styles.css" rel="stylesheet">
    <style>
        #log {
            position:absolute;
            top:0;
            right:0;
            width:290px;
            height:500px;
            border:1px solid #CCC;
            padding:15px;
            overflow: hidden;
            line-height: 1.2em;
            font-size:0.8em;
            font-family: Menlo, Monaco, Consolas, "Courier New", monospace;
        }

        #info {
            width:450px;
        }
        p { margin:0; }
        p.system { color: black; }
        p.transition { color: blue; }
        p.action { color: red; }
        p.state { color: green; }

        p.transition-end {
            margin-top:0.5em;
        }

        #log span{
            display: inline-block;
        }
        span.index {
            width:25px;
            margin-right: 10px;
            text-align: right;
        }

    </style>
</head>
<body>

    <h1>Events</h1>

    <main class="states">

        <section id="log">

        </section>

        <section id="states">
            <article id="a">State A</article>
            <article id="b">State B</article>
            <article id="c">State C</article>
        </section>

        <section id="controls">
            <button class="btn btn-sm" name="back">Back</button>
            <button class="btn btn-sm" name="next">Next</button>
        </section>

    </main>

    <section id="info">
        <p>This example navigates 4 states using only 2 actions, <code>next</code> and <code>back</code>.</p>
    </section>

    <script>

        function onEvent(event)
        {
            log(event.namespace, event.type);
        }

        var config = {

            initial: 'a',

            final: 'c',

            debug: true,

            events: [
                {name: 'next', from: 'a', to: 'b'},
                {name: 'next', from: 'b', to: 'c'},
                {name: 'next', from: 'c', to: 'a'},

                {name: 'back', from: 'c', to: 'b'},
                {name: 'back', from: 'b', to: 'a'},
                {name: 'back', from: 'a', to: 'c'}
            ],

            handlers: {

                update              :onEvent,
                reset               :onEvent,
                complete            :onEvent,

                'transition.start'  :onEvent,
                'transition.pause'  :onEvent,
                'transition.resume' :onEvent,
                'transition.cancel' :onEvent,
                'transition.end'    :onEvent,

                'action.start'      :onEvent,
                'action.end'        :onEvent,
                'state.enter'       :onEvent,
                'state.leave'       :onEvent,
                'system.change'     :onEvent,

                'enter:c'           :function(event){
                    event.pause();
                    setTimeout(event.resume, 2000);
                }


            }
        };

        setup(new StateMachine(document, config));

    </script>

    <script>
        var index = 1;
        function log(namespace, type, message)
        {
            message = message || '';
            var className = namespace+ ' ' +namespace+ '-' +type;
            var html =
            [
                '<span class="index">' +(index++)+ '</span>',
                '<span class="event">' +namespace+ '.' +type+ '</span>',
                '<span class="message">' +message+ '</span>'
            ];
            $('#log').prepend('<p class="' +className+ '">' +html.join('')+'</p>');
        }
    </script>
</body>
</html>